
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2. Leitura e escrita da bases de dados &#8212; Introdução a Polars para xuxus</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'aula2_leitura';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3. Exploração inicial" href="aula3_exploracao.html" />
    <link rel="prev" title="1. Instalação e importação do polars" href="aula1_instalacao.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="aula0_intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Introdução a Polars para xuxus</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="aula0_intro.html">
                    0. Introdução
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="aula1_instalacao.html">1. Instalação e importação do polars</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">2. Leitura e escrita da bases de dados</a></li>
<li class="toctree-l1"><a class="reference internal" href="aula3_exploracao.html">3. Exploração inicial</a></li>
<li class="toctree-l1"><a class="reference internal" href="aula4_tratamento.html">4. Tratamento e seleção de colunas</a></li>
<li class="toctree-l1"><a class="reference internal" href="aula5_analiseInicial.html">5. Visão geral inicial</a></li>
<li class="toctree-l1"><a class="reference internal" href="aula6_analise_pt1.html">6. Análise dos dados - Parte 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="aula7_analise_pt2.html">7. Análise dos dados - Parte 2</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/bdcdo/curso-polars" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/bdcdo/curso-polars/issues/new?title=Issue%20on%20page%20%2Faula2_leitura.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/aula2_leitura.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>2. Leitura e escrita da bases de dados</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#leitura-de-arquivos-csv">Leitura de arquivos csv</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#escrita-da-base-de-dados">Escrita da base de dados</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="leitura-e-escrita-da-bases-de-dados">
<h1>2. Leitura e escrita da bases de dados<a class="headerlink" href="#leitura-e-escrita-da-bases-de-dados" title="Link to this heading">#</a></h1>
<p>Começamos sempre do mesmo jeito:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">polars</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>
</pre></div>
</div>
</div>
</div>
<p>O <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span></code> só é necessário se você nunca usou a biblioteca antes. Nos usos seguintes, basta importar a biblioteca e, por convenção, sempre apelidamos o polars como pl.</p>
<section id="leitura-de-arquivos-csv">
<h2>Leitura de arquivos csv<a class="headerlink" href="#leitura-de-arquivos-csv" title="Link to this heading">#</a></h2>
<p>Feito o import, vamos ler a base de dados em si e salvar em uma variável chamada <code class="docutils literal notranslate"><span class="pre">df</span></code>, abreviação de DataFrame, que é como chamamos planilhas no python.</p>
<p>As funções de leitura de bases de dados do polars seguem sempre o mesmo formato: <code class="docutils literal notranslate"><span class="pre">read_&lt;formato&gt;</span></code>. Vamos usar aqui o <code class="docutils literal notranslate"><span class="pre">read_csv</span></code>, já que é este o formato da base de dados.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;bolsas_no_brasil_concluidas.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ComputeError</span><span class="g g-Whitespace">                              </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;bolsas_no_brasil_concluidas.csv&#39;</span><span class="p">)</span>

<span class="nn">File ~/Desktop/dev/curso-polars/.venv/lib/python3.12/site-packages/polars/_utils/deprecation.py:119,</span> in <span class="ni">deprecate_renamed_parameter.&lt;locals&gt;.decorate.&lt;locals&gt;.wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">114</span> <span class="nd">@wraps</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">115</span> <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">116</span>     <span class="n">_rename_keyword_argument</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">117</span>         <span class="n">old_name</span><span class="p">,</span> <span class="n">new_name</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">function</span><span class="o">.</span><span class="vm">__qualname__</span><span class="p">,</span> <span class="n">version</span>
<span class="g g-Whitespace">    </span><span class="mi">118</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">119</span>     <span class="k">return</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/Desktop/dev/curso-polars/.venv/lib/python3.12/site-packages/polars/_utils/deprecation.py:119,</span> in <span class="ni">deprecate_renamed_parameter.&lt;locals&gt;.decorate.&lt;locals&gt;.wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">114</span> <span class="nd">@wraps</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">115</span> <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">116</span>     <span class="n">_rename_keyword_argument</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">117</span>         <span class="n">old_name</span><span class="p">,</span> <span class="n">new_name</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">function</span><span class="o">.</span><span class="vm">__qualname__</span><span class="p">,</span> <span class="n">version</span>
<span class="g g-Whitespace">    </span><span class="mi">118</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">119</span>     <span class="k">return</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/Desktop/dev/curso-polars/.venv/lib/python3.12/site-packages/polars/_utils/deprecation.py:119,</span> in <span class="ni">deprecate_renamed_parameter.&lt;locals&gt;.decorate.&lt;locals&gt;.wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">114</span> <span class="nd">@wraps</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">115</span> <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">116</span>     <span class="n">_rename_keyword_argument</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">117</span>         <span class="n">old_name</span><span class="p">,</span> <span class="n">new_name</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">function</span><span class="o">.</span><span class="vm">__qualname__</span><span class="p">,</span> <span class="n">version</span>
<span class="g g-Whitespace">    </span><span class="mi">118</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">119</span>     <span class="k">return</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/Desktop/dev/curso-polars/.venv/lib/python3.12/site-packages/polars/io/csv/functions.py:540,</span> in <span class="ni">read_csv</span><span class="nt">(source, has_header, columns, new_columns, separator, comment_prefix, quote_char, skip_rows, skip_lines, schema, schema_overrides, null_values, missing_utf8_is_empty_string, ignore_errors, try_parse_dates, n_threads, infer_schema, infer_schema_length, batch_size, n_rows, encoding, low_memory, rechunk, use_pyarrow, storage_options, skip_rows_after_header, row_index_name, row_index_offset, sample_size, eol_char, raise_if_empty, truncate_ragged_lines, decimal_comma, glob)</span>
<span class="g g-Whitespace">    </span><span class="mi">532</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">533</span>     <span class="k">with</span> <span class="n">prepare_file_arg</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">534</span>         <span class="n">source</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">535</span>         <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>    <span class="mi">538</span>         <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">539</span>     <span class="p">)</span> <span class="k">as</span> <span class="n">data</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">540</span>         <span class="n">df</span> <span class="o">=</span> <span class="n">_read_csv_impl</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">541</span>             <span class="n">data</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">542</span>             <span class="n">has_header</span><span class="o">=</span><span class="n">has_header</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">543</span>             <span class="n">columns</span><span class="o">=</span><span class="n">columns</span> <span class="k">if</span> <span class="n">columns</span> <span class="k">else</span> <span class="n">projection</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">544</span>             <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">545</span>             <span class="n">comment_prefix</span><span class="o">=</span><span class="n">comment_prefix</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">546</span>             <span class="n">quote_char</span><span class="o">=</span><span class="n">quote_char</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">547</span>             <span class="n">skip_rows</span><span class="o">=</span><span class="n">skip_rows</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">548</span>             <span class="n">skip_lines</span><span class="o">=</span><span class="n">skip_lines</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">549</span>             <span class="n">schema_overrides</span><span class="o">=</span><span class="n">schema_overrides</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">550</span>             <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">551</span>             <span class="n">null_values</span><span class="o">=</span><span class="n">null_values</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">552</span>             <span class="n">missing_utf8_is_empty_string</span><span class="o">=</span><span class="n">missing_utf8_is_empty_string</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">553</span>             <span class="n">ignore_errors</span><span class="o">=</span><span class="n">ignore_errors</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">554</span>             <span class="n">try_parse_dates</span><span class="o">=</span><span class="n">try_parse_dates</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">555</span>             <span class="n">n_threads</span><span class="o">=</span><span class="n">n_threads</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">556</span>             <span class="n">infer_schema_length</span><span class="o">=</span><span class="n">infer_schema_length</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">557</span>             <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">558</span>             <span class="n">n_rows</span><span class="o">=</span><span class="n">n_rows</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">559</span>             <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span> <span class="k">if</span> <span class="n">encoding</span> <span class="o">==</span> <span class="s2">&quot;utf8-lossy&quot;</span> <span class="k">else</span> <span class="s2">&quot;utf8&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">560</span>             <span class="n">low_memory</span><span class="o">=</span><span class="n">low_memory</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">561</span>             <span class="n">rechunk</span><span class="o">=</span><span class="n">rechunk</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">562</span>             <span class="n">skip_rows_after_header</span><span class="o">=</span><span class="n">skip_rows_after_header</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">563</span>             <span class="n">row_index_name</span><span class="o">=</span><span class="n">row_index_name</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">564</span>             <span class="n">row_index_offset</span><span class="o">=</span><span class="n">row_index_offset</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">565</span>             <span class="n">eol_char</span><span class="o">=</span><span class="n">eol_char</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">566</span>             <span class="n">raise_if_empty</span><span class="o">=</span><span class="n">raise_if_empty</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">567</span>             <span class="n">truncate_ragged_lines</span><span class="o">=</span><span class="n">truncate_ragged_lines</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">568</span>             <span class="n">decimal_comma</span><span class="o">=</span><span class="n">decimal_comma</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">569</span>             <span class="n">glob</span><span class="o">=</span><span class="n">glob</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">570</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">572</span> <span class="k">if</span> <span class="n">new_columns</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">573</span>     <span class="k">return</span> <span class="n">_update_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">new_columns</span><span class="p">)</span>

<span class="nn">File ~/Desktop/dev/curso-polars/.venv/lib/python3.12/site-packages/polars/io/csv/functions.py:688,</span> in <span class="ni">_read_csv_impl</span><span class="nt">(source, has_header, columns, separator, comment_prefix, quote_char, skip_rows, skip_lines, schema, schema_overrides, null_values, missing_utf8_is_empty_string, ignore_errors, try_parse_dates, n_threads, infer_schema_length, batch_size, n_rows, encoding, low_memory, rechunk, skip_rows_after_header, row_index_name, row_index_offset, sample_size, eol_char, raise_if_empty, truncate_ragged_lines, decimal_comma, glob)</span>
<span class="g g-Whitespace">    </span><span class="mi">684</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">686</span> <span class="n">projection</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">parse_columns_arg</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">688</span> <span class="n">pydf</span> <span class="o">=</span> <span class="n">PyDataFrame</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">689</span>     <span class="n">source</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">690</span>     <span class="n">infer_schema_length</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">691</span>     <span class="n">batch_size</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">692</span>     <span class="n">has_header</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">693</span>     <span class="n">ignore_errors</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">694</span>     <span class="n">n_rows</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">695</span>     <span class="n">skip_rows</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">696</span>     <span class="n">skip_lines</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">697</span>     <span class="n">projection</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">698</span>     <span class="n">separator</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">699</span>     <span class="n">rechunk</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">700</span>     <span class="n">columns</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">701</span>     <span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">702</span>     <span class="n">n_threads</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">703</span>     <span class="n">path</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">704</span>     <span class="n">dtype_list</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">705</span>     <span class="n">dtype_slice</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">706</span>     <span class="n">low_memory</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">707</span>     <span class="n">comment_prefix</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">708</span>     <span class="n">quote_char</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">709</span>     <span class="n">processed_null_values</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">710</span>     <span class="n">missing_utf8_is_empty_string</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">711</span>     <span class="n">try_parse_dates</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">712</span>     <span class="n">skip_rows_after_header</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">713</span>     <span class="n">parse_row_index_args</span><span class="p">(</span><span class="n">row_index_name</span><span class="p">,</span> <span class="n">row_index_offset</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">714</span>     <span class="n">eol_char</span><span class="o">=</span><span class="n">eol_char</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">715</span>     <span class="n">raise_if_empty</span><span class="o">=</span><span class="n">raise_if_empty</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">716</span>     <span class="n">truncate_ragged_lines</span><span class="o">=</span><span class="n">truncate_ragged_lines</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">717</span>     <span class="n">decimal_comma</span><span class="o">=</span><span class="n">decimal_comma</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">718</span>     <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">719</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">720</span> <span class="k">return</span> <span class="n">wrap_df</span><span class="p">(</span><span class="n">pydf</span><span class="p">)</span>

<span class="ne">ComputeError</span>: found more fields than defined in &#39;Schema&#39;

<span class="n">Consider</span> <span class="n">setting</span> <span class="s1">&#39;truncate_ragged_lines=True&#39;</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>
<p>Ops. Tivemos um problema. Pra você ver como mesmo ler uma planilinha pode ser difícil quando somos exatos no que pedimos ao computador.</p>
<p>O erro não é óbvio nisso, mas o grande problema é que, em geral, arquivos .csv utilizam vírgulas para separar itens, mas o csv fornecido pela fapesp utiliza ponto e vírgula. Vamos então tentar de novo explicitando isso:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;bolsas_no_brasil_concluidas.csv&#39;</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Agora foi!</p>
<p>Vamos entender o que fizemos por partes.</p>
<p><code class="docutils literal notranslate"><span class="pre">df</span> <span class="pre">=</span> </code>: criamos uma variável chamada <code class="docutils literal notranslate"><span class="pre">df</span></code> e atribuímos a esta variável o resultado do que vem depois do <code class="docutils literal notranslate"><span class="pre">=</span></code>. Neste caso, isso significa que iremos salvar em <code class="docutils literal notranslate"><span class="pre">df</span></code> o conteúdo da planilha que iremos ler.
Feito isso, para acessar esse conteúdo basta digitarmos o nome da variável, que nomeei como <code class="docutils literal notranslate"><span class="pre">df</span></code> por convenção, mas poderia receber qualquer outro nome, como <code class="docutils literal notranslate"><span class="pre">dados_bolsas</span></code> ou <code class="docutils literal notranslate"><span class="pre">fapesp_brasil_concluido</span></code>. Para entender melhor as limitações dos nomes das variáveis, clique <a class="reference external" href="https://www.w3schools.com/python/python_variables_names.asp">aqui</a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">pl.read_csv()</span></code>: utilizamos a função <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code>da biblioteca <code class="docutils literal notranslate"><span class="pre">polars</span></code>, que apelidamos como <code class="docutils literal notranslate"><span class="pre">pl</span></code>, como vimos na aula anterior. Lembre-se sempre de utilizar os parenteses ao chamar qualquer função!</p>
<p><code class="docutils literal notranslate"><span class="pre">('bolsas_no_brasil_concluidas.csv',</span> <span class="pre">separator=';')</span></code>: dentro da função, passamos dois argumentos - chamamos de argumento os valores que estamos “colocando” na função - <code class="docutils literal notranslate"><span class="pre">'bolsas_no_brasil_concluidas.csv'</span></code> e <code class="docutils literal notranslate"><span class="pre">';'</span></code>.<br />
O primeiro argumento, <code class="docutils literal notranslate"><span class="pre">'bolsas_no_brasil_concluidas.csv'</span></code> se resume a nomear o arquivo que queremos ler. Este argumento é obrigatório. Sem dizer o que você quer ler, não tem como ler nada. Lembre-se de se atentar para o fato de que o formato do arquivo deve ser incluso em seu nome - neste caso, “.csv”.<br />
Já o argumento <code class="docutils literal notranslate"><span class="pre">';'</span></code> é opcional. Neste caso, acabamos sendo obrigados a colocá-lo, mas, ao ler a esmagadora maioria das planilhas, você não precisará informar nada do tipo. Isso acontece porque, se você não informa qual separador quer utilizar, o polars presume que deve utilizar a vírgula. Se quiser utilizar algo diferente, precisará pedir explicitamente ao polars que faça isso.<br />
Enquanto <code class="docutils literal notranslate"><span class="pre">';'</span></code> é um argumento (algo que estamos colocando dentro da função), <code class="docutils literal notranslate"><span class="pre">separator=</span></code> é um parâmetro. Pense nos parâmetros como caixinhas dentro da função que estão aguardando ser preenchidas. Se você não preenche o parâmetro separator, o polars vai lá e guarda uma vírgula lá, mas, se quiser que outra coisa seja guardada lá, vai precisar passar explicitamente um <strong>argumento</strong> informando o que deve ser utilizado.</p>
<p>Basicamente todas as funções do polars tem uma série de parâmetros que podem ou não ser preenchidos com argumentos - caso não sejam preenchidos, o polars vai guardar lá algo pré-definido. Não precisa entender em detalhes cada um, mas, se quiser conferir a lista completa dos parâmetros que podem ser utilizados com <code class="docutils literal notranslate"><span class="pre">read_csv</span></code>, confira a <a class="reference external" href="https://docs.pola.rs/api/python/stable/reference/api/polars.read_csv.html">documentação dessa função</a>.</p>
<p>Vamos utilizar bastante essa terminologia - argumentos e parâmetros - então é importante entender direito esses conceitos e tirar eventuais dúvidas antes de prosseguir. Lembre-se: um dos melhores usos de chatbots como o ChatGPT é tirar dúvidas sobre programação.</p>
</section>
<section id="escrita-da-base-de-dados">
<h2>Escrita da base de dados<a class="headerlink" href="#escrita-da-base-de-dados" title="Link to this heading">#</a></h2>
<p>Antes de entrar na exploração da base de dados em si, vamos terminar de ver tudo o que tem pra ver sobre leitura e escrita de dados.</p>
<p>Temos o nosso <code class="docutils literal notranslate"><span class="pre">df</span></code>. Se quisermos salvá-lo como csv, basta utilizar a função <code class="docutils literal notranslate"><span class="pre">write_csv()</span></code> - veja que o padrão de nomes será o mesmo do read, formado por <code class="docutils literal notranslate"><span class="pre">write_&lt;formato&gt;</span></code>. Ao utilizar essa função, passamos como argumento o nome como queremos salvar o arquivo, com a extensão inclusa.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">write_csv</span><span class="p">(</span><span class="s1">&#39;base_fapesp.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Se quisermos salvar em formato do excel, fazemos algo semelhante:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">write_excel</span><span class="p">(</span><span class="s1">&#39;base_fapesp.xlsx&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">df</span><span class="o">.</span><span class="n">write_excel</span><span class="p">(</span><span class="s1">&#39;base_fapesp.xlsx&#39;</span><span class="p">)</span>

<span class="nn">File ~/Desktop/dev/curso-polars/venv2/lib/python3.12/site-packages/polars/dataframe/frame.py:3482,</span> in <span class="ni">DataFrame.write_excel</span><span class="nt">(self, workbook, worksheet, position, table_style, table_name, column_formats, dtype_formats, conditional_formats, header_format, column_totals, column_widths, row_totals, row_heights, sparklines, formulas, float_precision, include_header, autofilter, autofit, hidden_columns, hide_gridlines, sheet_zoom, freeze_panes)</span>
<span class="g g-Whitespace">   </span><span class="mi">3114</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">3115</span><span class="sd"> Write frame data to a table in an Excel workbook/worksheet.</span>
<span class="g g-Whitespace">   </span><span class="mi">3116</span><span class="sd"> </span>
<span class="sd">   (...)   3469 ...     ws.insert_chart(&quot;D1&quot;, chart)</span>
<span class="g g-Whitespace">   </span><span class="mi">3470</span><span class="sd"> &quot;&quot;&quot;</span>  <span class="c1"># noqa: W505</span>
<span class="g g-Whitespace">   </span><span class="mi">3471</span> <span class="kn">from</span><span class="w"> </span><span class="nn">polars.io.spreadsheet._write_utils</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">3472</span>     <span class="n">_unpack_multi_column_dict</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">3473</span>     <span class="n">_xl_apply_conditional_formats</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>   <span class="mi">3479</span>     <span class="n">_XLFormatCache</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">3480</span> <span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3482</span> <span class="n">xlsxwriter</span> <span class="o">=</span> <span class="n">import_optional</span><span class="p">(</span><span class="s2">&quot;xlsxwriter&quot;</span><span class="p">,</span> <span class="n">err_prefix</span><span class="o">=</span><span class="s2">&quot;Excel export requires&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3483</span> <span class="kn">from</span><span class="w"> </span><span class="nn">xlsxwriter.utility</span><span class="w"> </span><span class="kn">import</span> <span class="n">xl_cell_to_rowcol</span>
<span class="g g-Whitespace">   </span><span class="mi">3485</span> <span class="c1"># setup workbook/worksheet</span>

<span class="nn">File ~/Desktop/dev/curso-polars/venv2/lib/python3.12/site-packages/polars/dependencies.py:293,</span> in <span class="ni">import_optional</span><span class="nt">(module_name, err_prefix, err_suffix, min_version, min_err_prefix, install_message)</span>
<span class="g g-Whitespace">    </span><span class="mi">288</span>     <span class="n">suffix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">err_suffix</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">err_suffix</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">289</span>     <span class="n">err_message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">&#39;</span><span class="si">{</span><span class="n">module_name</span><span class="si">}</span><span class="s2">&#39;</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">290</span>         <span class="n">install_message</span>
<span class="g g-Whitespace">    </span><span class="mi">291</span>         <span class="ow">or</span> <span class="sa">f</span><span class="s2">&quot;Please install using the command `pip install </span><span class="si">{</span><span class="n">module_root</span><span class="si">}</span><span class="s2">`.&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">292</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">293</span>     <span class="k">raise</span> <span class="ne">ModuleNotFoundError</span><span class="p">(</span><span class="n">err_message</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">295</span> <span class="k">if</span> <span class="n">min_version</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">296</span>     <span class="n">min_version</span> <span class="o">=</span> <span class="n">parse_version</span><span class="p">(</span><span class="n">min_version</span><span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: Excel export requires &#39;xlsxwriter&#39; not found.
<span class="n">Please</span> <span class="n">install</span> <span class="n">using</span> <span class="n">the</span> <span class="n">command</span> <span class="err">`</span><span class="n">pip</span> <span class="n">install</span> <span class="n">xlsxwriter</span><span class="err">`</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>
<p>No entanto, ao rodar isso, temos um erro. Este erro acontece não porque não existe a função <code class="docutils literal notranslate"><span class="pre">write_excel</span></code>, mas sim porque, para rodar essa função, precisamos instalar algumas bibliotecas adicionais.</p>
<p>Para a instalação de polars ser mais rápidas, seus desenvolvedores fizeram com que você não fosse obrigado a instalar coisas que não irá usar. Vamos então instalar o o “xlsxwriter” sugerido pela mensagem de erro.</p>
<p>Para isso, rodamos agora <code class="docutils literal notranslate"><span class="pre">!pip</span> <span class="pre">install</span> <span class="pre">xlsxwriter</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>xlsxwriter
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/bin/bash: line 1: pip: command not found
</pre></div>
</div>
</div>
</div>
<p>Feito isso, agora tentamos de novo, agora com sucesso:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">write_excel</span><span class="p">(</span><span class="s1">&#39;base_fapesp.xlsx&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xlsxwriter.workbook.Workbook at 0x783472210e60&gt;
</pre></div>
</div>
</div>
</div>
<p>Como a base de dados é grandinha, pode demorar um pouco.</p>
<p>Para ler a planilha salva, vamos inicialmente ter o mesmo problema:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_excel</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;base_fapesp.xlsx&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">df_excel</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;base_fapesp.xlsx&#39;</span><span class="p">)</span>

<span class="nn">File ~/Desktop/dev/curso-polars/venv2/lib/python3.12/site-packages/polars/_utils/deprecation.py:119,</span> in <span class="ni">deprecate_renamed_parameter.&lt;locals&gt;.decorate.&lt;locals&gt;.wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">114</span> <span class="nd">@wraps</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">115</span> <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">116</span>     <span class="n">_rename_keyword_argument</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">117</span>         <span class="n">old_name</span><span class="p">,</span> <span class="n">new_name</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">function</span><span class="o">.</span><span class="vm">__qualname__</span><span class="p">,</span> <span class="n">version</span>
<span class="g g-Whitespace">    </span><span class="mi">118</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">119</span>     <span class="k">return</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/Desktop/dev/curso-polars/venv2/lib/python3.12/site-packages/polars/_utils/deprecation.py:119,</span> in <span class="ni">deprecate_renamed_parameter.&lt;locals&gt;.decorate.&lt;locals&gt;.wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">114</span> <span class="nd">@wraps</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">115</span> <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">116</span>     <span class="n">_rename_keyword_argument</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">117</span>         <span class="n">old_name</span><span class="p">,</span> <span class="n">new_name</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">function</span><span class="o">.</span><span class="vm">__qualname__</span><span class="p">,</span> <span class="n">version</span>
<span class="g g-Whitespace">    </span><span class="mi">118</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">119</span>     <span class="k">return</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/Desktop/dev/curso-polars/venv2/lib/python3.12/site-packages/polars/io/spreadsheet/functions.py:399,</span> in <span class="ni">read_excel</span><span class="nt">(source, sheet_id, sheet_name, table_name, engine, engine_options, read_options, has_header, columns, schema_overrides, infer_schema_length, include_file_paths, drop_empty_rows, drop_empty_cols, raise_if_empty)</span>
<span class="g g-Whitespace">    </span><span class="mi">259</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span><span class="sd"> Read Excel spreadsheet data into a DataFrame.</span>
<span class="g g-Whitespace">    </span><span class="mi">261</span><span class="sd"> </span>
<span class="sd">   (...)    395 ... )  # doctest: +SKIP</span>
<span class="g g-Whitespace">    </span><span class="mi">396</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">397</span> <span class="n">sources</span><span class="p">,</span> <span class="n">read_multiple_workbooks</span> <span class="o">=</span> <span class="n">_sources</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">398</span> <span class="n">frames</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>  <span class="c1"># type: ignore[assignment]</span>
<span class="ne">--&gt; </span><span class="mi">399</span>     <span class="n">_read_spreadsheet</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">400</span>         <span class="n">src</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">401</span>         <span class="n">sheet_id</span><span class="o">=</span><span class="n">sheet_id</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">402</span>         <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet_name</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">403</span>         <span class="n">table_name</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">404</span>         <span class="n">engine</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">405</span>         <span class="n">engine_options</span><span class="o">=</span><span class="n">engine_options</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">406</span>         <span class="n">read_options</span><span class="o">=</span><span class="n">read_options</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">407</span>         <span class="n">schema_overrides</span><span class="o">=</span><span class="n">schema_overrides</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">408</span>         <span class="n">infer_schema_length</span><span class="o">=</span><span class="n">infer_schema_length</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">409</span>         <span class="n">include_file_paths</span><span class="o">=</span><span class="n">include_file_paths</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">410</span>         <span class="n">raise_if_empty</span><span class="o">=</span><span class="n">raise_if_empty</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">411</span>         <span class="n">has_header</span><span class="o">=</span><span class="n">has_header</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">412</span>         <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">413</span>         <span class="n">drop_empty_rows</span><span class="o">=</span><span class="n">drop_empty_rows</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">414</span>         <span class="n">drop_empty_cols</span><span class="o">=</span><span class="n">drop_empty_cols</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">415</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">416</span>     <span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">sources</span>
<span class="g g-Whitespace">    </span><span class="mi">417</span> <span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">418</span> <span class="k">return</span> <span class="n">_unpack_read_results</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">419</span>     <span class="n">frames</span><span class="o">=</span><span class="n">frames</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">420</span>     <span class="n">read_multiple_workbooks</span><span class="o">=</span><span class="n">read_multiple_workbooks</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">421</span> <span class="p">)</span>

<span class="nn">File ~/Desktop/dev/curso-polars/venv2/lib/python3.12/site-packages/polars/io/spreadsheet/functions.py:671,</span> in <span class="ni">_read_spreadsheet</span><span class="nt">(source, sheet_id, sheet_name, table_name, engine, engine_options, read_options, schema_overrides, infer_schema_length, include_file_paths, columns, has_header, raise_if_empty, drop_empty_rows, drop_empty_cols)</span>
<span class="g g-Whitespace">    </span><span class="mi">668</span> <span class="n">schema_overrides</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">schema_overrides</span> <span class="ow">or</span> <span class="p">{})</span>
<span class="g g-Whitespace">    </span><span class="mi">670</span> <span class="c1"># establish the reading function, parser, and available worksheets</span>
<span class="ne">--&gt; </span><span class="mi">671</span> <span class="n">reader_fn</span><span class="p">,</span> <span class="n">parser</span><span class="p">,</span> <span class="n">worksheets</span> <span class="o">=</span> <span class="n">_initialise_spreadsheet_parser</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">672</span>     <span class="n">engine</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">engine_options</span>
<span class="g g-Whitespace">    </span><span class="mi">673</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">674</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">675</span>     <span class="c1"># parse data from the indicated sheet(s)</span>
<span class="g g-Whitespace">    </span><span class="mi">676</span>     <span class="n">sheet_names</span><span class="p">,</span> <span class="n">return_multiple_sheets</span> <span class="o">=</span> <span class="n">_get_sheet_names</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">677</span>         <span class="n">sheet_id</span><span class="p">,</span> <span class="n">sheet_name</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">worksheets</span>
<span class="g g-Whitespace">    </span><span class="mi">678</span>     <span class="p">)</span>

<span class="nn">File ~/Desktop/dev/curso-polars/venv2/lib/python3.12/site-packages/polars/io/spreadsheet/functions.py:855,</span> in <span class="ni">_initialise_spreadsheet_parser</span><span class="nt">(engine, source, engine_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">852</span>     <span class="k">return</span> <span class="n">_read_spreadsheet_openpyxl</span><span class="p">,</span> <span class="n">parser</span><span class="p">,</span> <span class="n">sheets</span>
<span class="g g-Whitespace">    </span><span class="mi">854</span> <span class="k">elif</span> <span class="n">engine</span> <span class="o">==</span> <span class="s2">&quot;calamine&quot;</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">855</span>     <span class="n">fastexcel</span> <span class="o">=</span> <span class="n">import_optional</span><span class="p">(</span><span class="s2">&quot;fastexcel&quot;</span><span class="p">,</span> <span class="n">min_version</span><span class="o">=</span><span class="s2">&quot;0.7.0&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">856</span>     <span class="n">reading_bytesio</span><span class="p">,</span> <span class="n">reading_bytes</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">857</span>         <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">BytesIO</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">858</span>         <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">859</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">860</span>     <span class="k">if</span> <span class="p">(</span><span class="n">reading_bytesio</span> <span class="ow">or</span> <span class="n">reading_bytes</span><span class="p">)</span> <span class="ow">and</span> <span class="n">parse_version</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">861</span>         <span class="n">module_version</span> <span class="o">:=</span> <span class="n">fastexcel</span><span class="o">.</span><span class="n">__version__</span>
<span class="g g-Whitespace">    </span><span class="mi">862</span>     <span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>

<span class="nn">File ~/Desktop/dev/curso-polars/venv2/lib/python3.12/site-packages/polars/dependencies.py:293,</span> in <span class="ni">import_optional</span><span class="nt">(module_name, err_prefix, err_suffix, min_version, min_err_prefix, install_message)</span>
<span class="g g-Whitespace">    </span><span class="mi">288</span>     <span class="n">suffix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">err_suffix</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">err_suffix</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">289</span>     <span class="n">err_message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">&#39;</span><span class="si">{</span><span class="n">module_name</span><span class="si">}</span><span class="s2">&#39;</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">290</span>         <span class="n">install_message</span>
<span class="g g-Whitespace">    </span><span class="mi">291</span>         <span class="ow">or</span> <span class="sa">f</span><span class="s2">&quot;Please install using the command `pip install </span><span class="si">{</span><span class="n">module_root</span><span class="si">}</span><span class="s2">`.&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">292</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">293</span>     <span class="k">raise</span> <span class="ne">ModuleNotFoundError</span><span class="p">(</span><span class="n">err_message</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">295</span> <span class="k">if</span> <span class="n">min_version</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">296</span>     <span class="n">min_version</span> <span class="o">=</span> <span class="n">parse_version</span><span class="p">(</span><span class="n">min_version</span><span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: required package &#39;fastexcel&#39; not found.
<span class="n">Please</span> <span class="n">install</span> <span class="n">using</span> <span class="n">the</span> <span class="n">command</span> <span class="err">`</span><span class="n">pip</span> <span class="n">install</span> <span class="n">fastexcel</span><span class="err">`</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>
<p>Vamos então seguir a sugestão de instalar <code class="docutils literal notranslate"><span class="pre">fastexcel</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>fastexcel
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/bin/bash: line 1: pip: command not found
</pre></div>
</div>
</div>
</div>
<p>E, ao tentar de novo ler o arquivo, irá funcionar:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_excel</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;base_fapesp.xlsx&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Could not determine dtype for column 7, falling back to string
Could not determine dtype for column 8, falling back to string
Could not determine dtype for column 10, falling back to string
Could not determine dtype for column 11, falling back to string
Could not determine dtype for column 12, falling back to string
Could not determine dtype for column 14, falling back to string
Could not determine dtype for column 15, falling back to string
Could not determine dtype for column 23, falling back to string
Could not determine dtype for column 26, falling back to string
</pre></div>
</div>
</div>
</div>
<p>Pode ignorar eventuais alertas sobre dtype. Elas são destinadas a usos mais avançados desse tipo de ferramenta.</p>
<p>Note como as mensagens de erro muitas vezes são não causas para pânico, mas sim indicações do que precisamos fazer para avançar.</p>
<p>Agora que sabemos como ler a planilha, vamos explorá-la!</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="aula1_instalacao.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">1. Instalação e importação do polars</p>
      </div>
    </a>
    <a class="right-next"
       href="aula3_exploracao.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">3. Exploração inicial</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#leitura-de-arquivos-csv">Leitura de arquivos csv</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#escrita-da-base-de-dados">Escrita da base de dados</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Bruno da Cunha de Oliveira
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>